# 标签自定义功能 - 快速开始指南

## 🚀 立即开始使用

### 第一步：在 Xcode 中添加新文件

由于文件是通过代码生成的，需要在 Xcode 中添加到项目：

#### 快速添加方法（推荐）

1. **打开 Xcode**
   ```bash
   open migraine_note/migraine_note.xcodeproj
   ```

2. **在 Xcode 中批量添加文件**
   - 菜单：File → Add Files to "migraine_note"
   - 导航到项目根目录
   - 按住 Command 键，多选以下文件：

   **Models 文件夹**
   - `CustomLabelConfig.swift`

   **Services 文件夹**
   - `LabelManager.swift`

   **Views/Settings/LabelManagement 文件夹**（需要先创建 LabelManagement 文件夹）
   - `LabelManagementView.swift`
   - `SymptomLabelEditor.swift`
   - `TriggerLabelEditor.swift`
   - `MedicationPresetEditor.swift`
   - `LabelRow.swift`

3. **添加选项**
   - ❌ 取消勾选 "Copy items if needed"（文件已在正确位置）
   - ✅ 勾选 Target "migraine_note"
   - 点击 "Add"

### 第二步：编译和运行

1. **清理构建文件夹**（可选但推荐）
   ```
   Cmd + Shift + K
   ```

2. **编译项目**
   ```
   Cmd + B
   ```

3. **运行应用**
   ```
   Cmd + R
   ```

### 第三步：体验功能

#### 1️⃣ 查看默认标签

- 打开 App → 设置 → 标签管理
- 查看三个标签类型（症状、诱因、药物预设）
- 所有默认标签已自动初始化

#### 2️⃣ 添加自定义标签

**添加症状**：
1. 标签管理 → 症状
2. 点击右下角"+"按钮
3. 输入症状名称（如"头晕脑胀"）
4. 选择类型（西医/中医）
5. 保存

**添加诱因**：
1. 标签管理 → 诱因
2. 点击右下角"+"按钮
3. 输入诱因名称（如"吃火锅"）
4. 选择分类（如"饮食"）
5. 保存

**添加药物预设**：
1. 标签管理 → 药物预设
2. 点击右下角"+"按钮
3. 输入药物名称（如"头痛散"）
4. 选择分类
5. 保存

#### 3️⃣ 隐藏不需要的标签

- 在标签列表中，点击眼睛图标即可隐藏
- 隐藏的标签不会在录入界面显示
- 再次点击可重新显示

#### 4️⃣ 在录入中使用

1. 开始记录偏头痛发作
2. 在症状选择步骤，只会看到未隐藏的标签
3. 自定义标签和默认标签混合显示
4. 正常选择和保存

## 📱 功能演示截图位置

录入流程中的标签使用：
- Step3: 症状选择（西医 + 中医症状）
- Step4: 诱因选择（按7个分类展示）
- Step5: 添加药物（从预设列表快速选择）

设置中的标签管理：
- 设置 → 标签管理
  - 症状 Tab
  - 诱因 Tab
  - 药物预设 Tab

## 🔍 验证功能是否正常

### 检查点 1: 默认标签初始化
- 打开 Xcode 控制台
- 启动应用时应看到："开始初始化默认标签..." 和 "默认标签初始化完成"
- 仅首次启动显示，之后启动显示："默认标签已存在，跳过初始化"

### 检查点 2: 标签管理界面
- 设置 → 标签管理
- 应该看到三个 Tab
- 症状：6个西医症状 + 6个中医症状
- 诱因：49个诱因（分7个类别）
- 药物预设：15个药物（分4个类别）

### 检查点 3: 添加自定义标签
- 添加一个自定义症状
- 返回首页 → 开始记录
- 在症状选择步骤应该能看到新添加的症状

### 检查点 4: 隐藏标签
- 隐藏"恶心"症状
- 返回记录流程
- 症状列表中不应出现"恶心"

### 检查点 5: 数据持久化
- 完全关闭应用
- 重新打开
- 自定义标签和隐藏状态应该保持

## ⚠️ 常见问题

### Q1: 新文件在 Xcode 中显示红色
**A**: 文件未添加到项目，按照"第一步"重新添加

### Q2: 编译错误 "Cannot find type 'CustomLabelConfig'"
**A**: CustomLabelConfig.swift 未添加到项目，需要添加

### Q3: 应用启动后没有默认标签
**A**: 检查 migraine_noteApp.swift 是否正确添加了初始化代码

### Q4: 录入界面没有显示标签
**A**: 检查是否所有标签都被隐藏了，或者数据库初始化失败

### Q5: 修改标签后录入界面没更新
**A**: 应该是自动更新的，如果没有更新可能是 @Query 未正确配置

## 📝 完整文档

- **实施总结**: `LABEL_CUSTOMIZATION_IMPLEMENTATION_SUMMARY.md`
- **功能指南**: `LABEL_CUSTOMIZATION_GUIDE.md`
- **计划文档**: `.cursor/plans/自定义标签管理系统_*.plan.md`

## 🎉 完成！

恭喜！标签自定义功能已经完全实现并准备就绪。

现在用户可以：
- ✨ 自定义症状标签（西医 + 中医）
- ✨ 自定义诱因标签（7个分类）
- ✨ 自定义药物预设（4个分类）
- ✨ 隐藏不需要的默认标签
- ✨ 实时生效，无需重启

享受更个性化的偏头痛管理体验！
